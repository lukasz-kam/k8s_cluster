{
  "id": null,
  "uid": "memory-usage-full",
  "title": "Memory Usage Dashboard",
  "tags": ["kubernetes", "memory", "pods", "nodes"],
  "timezone": "browser",
  "schemaVersion": 36,
  "version": 1,
  "refresh": "30s",
  "style": "dark",
  "panels": [
    {
      "type": "timeseries",
      "title": "Memory Usage by Pod",
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum by (pod) (container_memory_usage_bytes{container!=\"\", container!=\"POD\"})",
          "legendFormat": "{{pod}}",
          "refId": "A"
        }
      ],
      "fieldConfig": {
        "defaults": { "unit": "bytes" },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "right", "showLegend": true },
        "tooltip": { "mode": "single" }
      },
      "gridPos": { "h": 12, "w": 24, "x": 0, "y": 0 }
    },
    {
      "type": "timeseries",
      "title": "Memory Usage by Node (Containers)",
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum by (node) (container_memory_usage_bytes{container!=\"\"} * on(pod) group_left(node) kube_pod_info)",
          "legendFormat": "{{node}}",
          "refId": "D"
        }
      ],
      "fieldConfig": {
        "defaults": { "unit": "bytes" },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "right", "showLegend": true },
        "tooltip": { "mode": "single" }
      },
      "gridPos": { "h": 8, "w": 24, "x": 0, "y": 28 }
    },
    {
      "type": "timeseries",
      "title": "Memory Usage % by Node",
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "100 * (1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)) * on(instance) group_left() node_uname_info",
          "legendFormat": "{{node}}",
          "refId": "C"
        }
      ],
      "fieldConfig": {
        "defaults": { "unit": "percent" },
        "overrides": []
      },
      "options": {
        "legend": { "displayMode": "table", "placement": "right", "showLegend": true },
        "tooltip": { "mode": "single" }
      },
      "gridPos": { "h": 8, "w": 24, "x": 0, "y": 20 }
    }
  ],
  "time": { "from": "now-1h", "to": "now" }
}
